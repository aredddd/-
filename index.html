<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>俸禄计算器</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg: #f5f0e8;
      --card: #fffef9;
      --ink: #1a1a1a;
      --muted: #5c5c5c;
      --border: #d4cfc4;
      --accent: #8b6914;
      --accent-soft: rgba(139, 105, 20, 0.12);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      padding: 32px 16px 48px;
      background: var(--bg);
      font-family: "Noto Serif SC", "Songti SC", serif;
      color: var(--ink);
      line-height: 1.6;
    }
    .container { max-width: 560px; margin: 0 auto; }
    h1 {
      text-align: center;
      font-weight: 600;
      letter-spacing: 6px;
      font-size: 1.75rem;
      margin: 0;
    }
    .subtitle {
      text-align: center;
      font-size: 13px;
      color: var(--muted);
      margin-top: 8px;
      letter-spacing: 2px;
    }
    .card {
      margin-top: 24px;
      padding: 24px;
      background: var(--card);
      border-radius: 16px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.06);
      border: 1px solid var(--border);
    }
    label {
      display: block;
      margin-top: 16px;
      font-size: 14px;
      color: var(--muted);
    }
    label:first-of-type { margin-top: 0; }
    input, select {
      width: 100%;
      margin-top: 6px;
      padding: 12px 14px;
      font-size: 16px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: #fff;
      font-family: inherit;
    }
    input:focus, select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--accent-soft);
    }
    .dynasty-desc {
      margin-top: 12px;
      padding: 12px 14px;
      font-size: 13px;
      color: var(--muted);
      background: var(--accent-soft);
      border-radius: 10px;
      border-left: 3px solid var(--accent);
      line-height: 1.65;
      display: none;
    }
    .dynasty-desc.visible { display: block; }
    .result {
      margin-top: 24px;
      padding-top: 20px;
      border-top: 1px dashed var(--border);
      text-align: center;
    }
    .result-label { font-size: 13px; color: var(--muted); }
    .liang {
      font-size: 2.25rem;
      font-weight: 600;
      margin: 8px 0 4px;
      letter-spacing: 2px;
      color: var(--accent);
    }
    .rank {
      font-size: 17px;
      font-weight: 500;
      margin-top: 6px;
    }
    .life {
      margin-top: 14px;
      text-align: left;
      font-size: 14px;
      line-height: 1.85;
      color: var(--muted);
      padding: 0 4px;
    }
    .goods {
      margin-top: 12px;
      padding: 10px 12px;
      font-size: 13px;
      line-height: 1.6;
      color: var(--muted);
      background: rgba(0,0,0,0.04);
      border-radius: 8px;
    }
    .goods strong { color: var(--ink); }
    .price-link { font-size: 12px; margin-top: 6px; }
    .price-link a { color: var(--accent); text-decoration: none; }
    .price-link a:hover { text-decoration: underline; }
    .foot-note {
      margin-top: 28px;
      padding: 14px 16px;
      font-size: 12px;
      color: var(--muted);
      background: var(--accent-soft);
      border-radius: 10px;
      line-height: 1.7;
    }
    .foot-note strong { color: var(--ink); }
    footer {
      margin-top: 24px;
      text-align: center;
      font-size: 12px;
      color: #999;
    }
    @media (min-width: 400px) {
      .liang { font-size: 2.5rem; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>俸禄计算器</h1>
    <p class="subtitle">以白银计俸 · 观古今之所得</p>

    <div class="card">
      <label for="salary">金额（元）</label>
      <input id="salary" type="number" placeholder="例如 23000" min="0" inputmode="numeric" />
      <label for="salaryType">薪资类型</label>
      <select id="salaryType">
        <option value="monthly" selected>按月（当前输入为月薪）</option>
        <option value="yearly">按年（当前输入为年薪）</option>
      </select>

      <label for="price">今日银价（元 / 克）</label>
      <input id="price" type="number" step="0.01" value="6.0" min="0.01" placeholder="默认约 6 元/克" />
      <p class="price-link">查实时银价：<a href="https://ag.cngold.org/bybj/" target="_blank" rel="noopener">金投网 · 白银报价</a></p>

      <label for="dynasty">朝代</label>
      <select id="dynasty">
        <option value="han">汉代</option>
        <option value="sui">隋代</option>
        <option value="tang">唐代</option>
        <option value="song">宋代</option>
        <option value="yuan">元代</option>
        <option value="ming">明代</option>
        <option value="qing">清代</option>
      </select>
      <div id="dynastyDesc" class="dynasty-desc" aria-live="polite"></div>

      <div class="result">
        <div class="result-label">折合月俸（银两）</div>
        <div class="liang" id="liang">— 两</div>
        <div class="rank" id="rank"></div>
        <div class="life" id="life"></div>
        <div class="goods" id="goods" aria-live="polite"></div>
      </div>

      <div class="foot-note">
        <strong>换算说明：</strong>1 两 = 50 克（明清常制）。历代计量与支付方式不同（钱帛、禄米、银两等），此处统一折银便于比较。非史学精算，仅供文化与认知参考。
      </div>
    </div>

    <footer>
      仅供娱乐与认知参考 · 不作为学术依据
      <br />
      如果你觉得有趣，欢迎在
      <a href="https://github.com/aredddd/fenglucalculater" target="_blank" rel="noopener">GitHub</a>
      上点个 ⭐ Star
    </footer>
  </div>

  <script>
    const salaryInput = document.getElementById("salary");
    const salaryTypeSelect = document.getElementById("salaryType");
    const priceInput = document.getElementById("price");
    const dynastySelect = document.getElementById("dynasty");
    const dynastyDescEl = document.getElementById("dynastyDesc");
    const liangEl = document.getElementById("liang");
    const rankEl = document.getElementById("rank");
    const lifeEl = document.getElementById("life");
    const goodsEl = document.getElementById("goods");

    // 按明清常价粗算：1 两 ≈ 1 石米、≈ 2 匹布（粗布）、≈ 10 斤肉（各地各时波动大，仅作量级参考）
    function formatGoods(liang) {
      if (liang <= 0) return "";
      const rice = liang >= 0.1 ? liang.toFixed(1) : liang.toFixed(2);
      const cloth = Math.max(0, Math.round(liang * 2));
      const meat = Math.max(0, Math.round(liang * 10));
      return "约可购 米 " + rice + " 石、布 " + cloth + " 匹、肉 " + meat + " 斤（按当时常价粗算）";
    }

    const DYNASTY_DESCRIPTIONS = {
      han: "汉代俸禄以「石」计粮为主，下层吏卒多领实物口粮，上层官员则兼得钱帛赏赐与封邑。此处把典型石数折算为银两，只做大致量级换算，方便和后世对照。",
      sui: "隋代官俸以禄米、职田为主，京官与外官、文官与武职在石数上差别明显。高品官员除俸禄外，往往另有封赐与田宅，本表只取其大致俸禄水准。",
      tang: "唐代前期官员兼享俸料、禄米与职田，中后期逐渐增加现钱给付。三品以上高官多有宽广宅第与大量僮仆，实际生活质量远超单纯俸禄数字。",
      song: "宋代官员待遇在历代中偏优，除了基本俸钱，还有禄粟、职田、折帛与添支等多种名目，被称作“厚禄养廉”。此处尝试把这些收入折成银两，只反映不同品级的大致生活阶层。",
      yuan: "元代官俸以钞与粮为主，不同色目与品级在俸钞、禄米数量上差异显著。纸钞多次贬值，本表按相对稳定时段折算成银两，只反映大致购买力而非精确数额。",
      ming: "明代中后期官员领取银米兼行的正俸，但名义数额普遍偏低，实际开支多依赖火耗、羡余与地方规礼。这里只按正俸折银，刻意压低数值，以便和“养廉”极高的清代形成对比。",
      qing: "清代实行俸银、禄米与养廉银并行制度，其中养廉银常远高于明面正俸。高官实际收入差异巨大，本表仅以典型俸银与养廉的综合水准，粗略示意不同品级的生活层级。"
    };

    const FENGLU_DATA = {
      han: [
        { max: 10, rank: "胥役 / 邑卒", life: "在衙门、仓场或军营中服杂役，所得多为零星口粮与少量钱帛。日常多食糙米与杂粮，遇荒年极易受波及，家庭风险极高。" },
        { max: 20, rank: "斗食小吏 / 役卒", life: "秩卑禄薄，日食粗粮与粗菜，衣着多为布麻，偶有肉食已属奢侈。居住在城邑边缘或乡里陋室，几无积蓄可言。" },
        { max: 50, rank: "百石至三百石", life: "衣食大致无忧，可养妻儿数口，逢年过节能稍加犒劳。多居城郭普通宅舍，有少量余钱应付人情往来。" },
        { max: 100, rank: "六百石左右（县令级）", life: "俸足以养廉，粮米充盈，肉食与酒水不绝于席。家中有车马与仆役，宅第方正宽敞，属一县显望之家。" },
        { max: 300, rank: "二千石（郡守级）", life: "位列郡守，一郡赋税在手，平日觥筹交错、宾客盈门。府邸深宅大院，僮仆众多，族人多蒙其荫，生活极为体面。" },
        { max: Infinity, rank: "万石 / 公卿", life: "身为公卿，或封侯食万石之禄，除正俸外还有封邑、赏赐与田庄。家中宾客如云，声势赫奕，财富与权位难以用银两计量。" }
      ],
      // han 数值基本合理（二千石年约200-300两等价，六百石约50-100两），无需大改
      sui: [
        { max: 10, rank: "杂役 / 农隶", life: "主要依赖短工与田间劳作换取口粮，缺乏稳定俸禄来源，常介于官府役使与乡里零工之间，生活极不稳定。" },
        { max: 20, rank: "流外吏 / 胥吏", life: "俸米有限，多在州县衙门中奔走，常以抄写、公事奔波为生。日常勉强温饱，居坊里小宅，家用紧张，很难积累家产。" },
        { max: 50, rank: "八九品及外官低品", life: "禄米与职田合计，可养一家老小，粮仓尚称宽裕。衣着虽不华贵，但能保持干净体面，偶有小宗族礼仪与宴饮。" },
        { max: 100, rank: "五六品（州郡属官）", life: "俸料充足，有固定俸米与部分田租收入，家中仆役一二人，车马可供日常出行。与地方士绅往来频仍，生活渐有余裕。" },
        { max: 300, rank: "三四品（刺史级）", life: "高官厚禄，除禄米外更有职田与赏赐，日常设宴接待宾客属常事。府宅深院，多有家仆与书佐，一州一郡多仰望其门庭。" },
        { max: Infinity, rank: "一二品 / 宰辅", life: "位高权重，掌地方与中央重权，恩赏与封赐远超俸禄本身。家族经营田庄、商贾，财富来源多元，难以以单一俸禄衡量。" }
      ],
      // sui 数值合理（低品几十两，高品数百两等价），保持
      tang: [
        { max: 10, rank: "杂役 / 兵卒", life: "多在军府与官署中从事粗重差役，俸粮微薄，常需兼作打短工补贴家用。衣食勉强温饱，遇战乱与徭役时境遇尤为艰辛。" },
        { max: 20, rank: "流外 / 胥吏", life: "多为吏员与下级文书，领取基本俸粮，日常生活清简。衣着以麻布与粗布为主，在京城或州府中多住于坊巷小屋。" },
        { max: 50, rank: "八九品及基层", life: "衣食优渥，可常食鱼肉与细粮，能负担子女启蒙教育。与当地士人稍有往来，节庆时亦能设小宴款待亲友。" },
        { max: 100, rank: "五品至七品", life: "拥有马车与宽敞宅第，家中有仆役照料日常起居。常往来于州县、京城官场与士林之间，诗酒唱和、游宴为日常生活一部分。" },
        { max: 200, rank: "三品以上", life: "钟鸣鼎食之家，府第恢宏，厅堂中陈设精致器物。常有门客与宾僚出入，宗族亦因其显宦而获田产与名望。" },  // 原300 → 200
        { max: Infinity, rank: "宰辅 / 勋贵", life: "身处权力核心，一人之下、万人之上。除俸禄与职田外，封爵、赐第、赐田层出不穷，生活奢华到近乎难以用金银计量。" }
      ],
      song: [
        { max: 10, rank: "胥役 / 仓卒", life: "寄身于仓库、狱舍或城防等下层岗位，依赖微薄俸钱与零星油水过活。家人多仍需务农或做小买卖，整体生活逼仄。" },
        { max: 20, rank: "小吏 / 低级武职", life: "虽有俸钱与一定禄粟，但除家庭基本开支外所余不多。多住城坊狭小宅院，衣着整洁却不奢华，偶能参与小规模文会或乡饮。" },
        { max: 100, rank: "选人 / 州县属官", life: "宋代基层文官待遇相对优厚，添支与折帛使其衣食常有盈余。可供子弟入学读书，与地方士绅交往频繁，节庆时有较正式的家宴与应酬。" },
        { max: 300, rank: "京朝官 / 知州级", life: "钱粟丰足，家中有数名仆从打理起居，宅第多临街设堂，内有书房与小园。常与同僚、文士聚会赋诗饮酒，日常生活颇具“士大夫风雅”气息。" },
        { max: 1000, rank: "侍郎、尚书级", life: "恩赏繁多，除高额俸禄外仍有种种折色与赏赐。府中园林精致，门客清客往来不断，宗族广购良田与宅第，成一方名门望族。" },
        { max: Infinity, rank: "宰执 / 使相", life: "位居宰执，既有丰厚俸给，又常获恩荫与赏田。家族中多人可藉其势力入仕或购田经营，财富来源远超俸禄本身，几乎代表了宋代士大夫的顶层生活。" }
      ],
      yuan: [
        { max: 10, rank: "杂役 / 戍卒", life: "长期在边军或府库中承担劳役，主要领取俸钞与粗粮。因钞法不稳，购买力常被侵蚀，家庭财务极为脆弱。" },
        { max: 20, rank: "吏员 / 巡检", life: "多领钞票与少量禄粮，受纸钞贬值影响，实际购买力有限。居住环境简陋，主要精力放在维持家用与应对日常物价波动上。" },
        { max: 50, rank: "八九品及路府属官", life: "俸钞与禄米结合，可基本保证家庭衣食，偶有盈余应对亲友往来。多住城郭内普通宅舍，对物价与钞法变动较为敏感。" },
        { max: 100, rank: "五六品（路总管等）", life: "俸给相对殷实，兼有一定的实物待遇，家中设有仆役负责出入与接待。蒙古、色目与汉人士大夫在此层面多注重仪容与排场。" },
        { max: 300, rank: "二三品（行省大员）", life: "高官厚禄，手握行省大权，受赐田庄与财物频仍。府邸宏大，宴客场面壮观，僮仆与随员众多，权力与经济利益高度捆绑。" },
        { max: Infinity, rank: "中书省 / 枢密重臣", life: "位极人臣，对朝政与军政有直接影响。因战功、恩宠与封赐而获得大量田产与财富，其经济实力往往超出单纯官俸数倍。" }
      ],
      // yuan 钞贬值严重，但折银后中低级偏低，保持合理
      ming: [
        { max: 10, rank: "差役 / 皂隶", life: "日常奔走于刑名、征税等基层事务，吃重活多报酬少。多居于城坊狭小巷弄，家人仍需兼做工匠或小贩以补家用。" },
        { max: 20, rank: "小吏 / 匠役", life: "正俸极薄，多依赖外快与手艺收入补贴家用。日常以粗粮与咸菜为主食，偶有肉食，多住在城坊狭窄的借居或陋室中。" },
        { max: 30, rank: "富户 / 胥吏", life: "凭借与官府往来的灰色收入，衣食较为丰足，可雇一名长工或丫鬟。居住在结构完整的小宅或两进院落中，逢年过节能置办像样宴席。" },
        { max: 50, rank: "县官 / 高俸", life: "名义正俸只有数十两，但加上各类规礼与油水，家用颇为宽裕。常着绸缎衣裳，出行有轿，有数名家仆与书吏服役，在一县之内颇具威望。" },
        { max: 100, rank: "知府 / 道台级", life: "名义俸禄并不惊人，但实权在手，火耗、羡余与地方馈赠远超俸银。宅第深院，家中仆役成行，常设宴款待上司与同僚，属于地方真正权势核心。" },
        { max: Infinity, rank: "封疆大吏 / 部院", life: "封疆大吏与部院重臣，既受朝廷倚重，又握地方实权。除俸禄与养廉外，还常受皇恩赏赐田宅与珍玩，其财富多与权势一并增长。" }
      ],
      qing: [
        { max: 10, rank: "皂隶 / 快手", life: "负责缉捕、押解与各类粗活，常以辛劳换取有限酒食与赏钱。工作风险与身家地位不成比例，家中多仍处于半贫困状态。" },
        { max: 20, rank: "书吏 / 差役", life: "正俸极薄，多凭规费、礼金与地方杂役收入维持体面。日常奔走于衙门与乡里之间，衣着尚可但居所狭窄，生活压力较大。" },
        { max: 50, rank: "州县属官 / 佐贰", life: "俸银有限，但常可分润部分养廉或灰色收入，衣食上已颇为宽裕。出席地方宴饮与礼仪频繁，需要维持一定的衣冠与礼节开销。" },
        { max: 100, rank: "正七品以上", life: "坐轿出行，宅院规整，有数名长工与伙计打理家务。除正俸与禄米外，有一定数额养廉银，使其能在同僚与乡绅之间保持体面交际。" },
        { max: 300, rank: "道台 / 巡抚", life: "养廉银远高于明面俸银，银钱往来巨大，需频繁设宴招待僚属与地方绅商。其府邸规模宏大，幕友与门客众多，地方政商网络高度依附其人。" },
        { max: Infinity, rank: "督抚 / 重臣", life: "握有一省乃至数省军政大权，养廉、规礼与暗中馈送远超俸禄。其财力往往与政治能量紧密相连，真正体现“非俸禄所能衡量”的权势阶层。" }
      ]
    };

    function showDynastyDesc() {
      const v = dynastySelect.value;
      dynastyDescEl.textContent = DYNASTY_DESCRIPTIONS[v] || "";
      dynastyDescEl.classList.toggle("visible", !!DYNASTY_DESCRIPTIONS[v]);
    }

    function calc() {
      const rawSalary = parseFloat(salaryInput.value);
      const price = parseFloat(priceInput.value);
      if (!rawSalary || !price || price <= 0) {
        liangEl.textContent = "— 两";
        rankEl.textContent = "";
        lifeEl.textContent = "";
        goodsEl.textContent = "";
        return;
      }
      // 按薪资类型换算为月薪
      const salary =
        salaryTypeSelect && salaryTypeSelect.value === "yearly"
          ? rawSalary / 12
          : rawSalary;
      const gram = salary / price;
      const liang = gram / 50;
      const dynasty = dynastySelect.value;
      liangEl.textContent = liang.toFixed(1) + " 两";
      const info = fengluInfo(liang, dynasty);
      rankEl.textContent = info ? info.rank : "";
      lifeEl.textContent = info ? info.life : "";
      goodsEl.textContent = formatGoods(liang);
    }

    function fengluInfo(liang, dynasty) {
      const tiers = FENGLU_DATA[dynasty];
      if (!tiers) return null;
      return tiers.find(d => liang <= d.max) || tiers[tiers.length - 1];
    }

    dynastySelect.addEventListener("change", () => { showDynastyDesc(); calc(); });
    salaryTypeSelect.addEventListener("change", calc);
    salaryInput.addEventListener("input", calc);
    priceInput.addEventListener("input", calc);

    // 从 GitHub 每日更新的 data/price.json 读取默认银价（失败则保持 6.0）
    // 加 ?t= 避免浏览器/CDN 缓存旧数据
    fetch("data/price.json?t=" + Date.now())
      .then(r => r.ok ? r.json() : Promise.reject())
      .then(d => { if (d && typeof d.cnyPerGram === "number") priceInput.value = Number(d.cnyPerGram).toFixed(2); })
      .catch(() => {})
      .finally(() => { showDynastyDesc(); calc(); });
  </script>
</body>
</html>
